<div ng-include src="'views/partial/nav.html'"></div>
<div class="container">
<h1>Orders</h1>
<form id="search" name="search" >
	<div class="form-group">
		<label class="control-label col-sm-2" for="name">Ημερομηνία έναρξης:</label>
		<div class="col-sm-10">
			<input class="form-control" date-time name="pickerMinDate" ng-model="dates.today" id="pickerMinDate" min-date="minDate" view="date" min-view="hours" timezone="UTC" format="MM-DD-YYYY hh:mm a">
		</div>
	</div>
	<div class="form-group">
		<label class="control-label col-sm-2" for="name">Ημερομηνία λήξης:</label>
		<div class="col-sm-10">
			<input class="form-control" date-time name="pickerMinDate" ng-model="dates.end" id="pickerMinDate" min-date="dates.end" view="date" min-view="hours" timezone="UTC" format="MM-DD-YYYY hh:mm a">
		</div>
	</div>
	<div class="form-group">
		<label class="control-label col-sm-2" for="name"></label>
		<div class="col-sm-10">
			<input type="button" value="Αναζήτηση" class="btn btn-success" ng-click="searchData(dates.today, dates.end)">
		</div>
	</div>
</form>
<table class="table table-striped table-hover" data-ng-init="getOrders()" ng-click='sort(head)'>
	<thead>
		<tr>
      <th>ID συναλλαγής</th>
      <th>Τύπος συναλλαγής</th>
			<th>Όνομα χρήστη</th>
			<th>Διεύθυνση</th>
			<th>Τηλέφωνο</th>
			<th>Κατάσταση</th>
      <th>Μέθοδος παράδοσης </th>
      <th>Κατηγορία</th>
      <th>Ποσότητα</th>
      <th>Ποσό</th>
			<th>Μερίδιο ποσού</th>
            <!-- <th>Edit</th> -->
			<th>Αλλαγή κατάστασης</th>
		</tr>
	</thead>
    <tbody ng-if='orders.length == 0'>
        <tr>
            <td colspan='12'>No Data found</td>
        </tr>
    </tbody>
	<tbody ng-if='orders.length != 0' ng-init="total = 0" ng-init="shared = 0">
		<tr ng-repeat='order in orders'>
      <td>{{order.trans_id}}</td>
      <td>{{order.trans_type}}</td>
			<td>{{order.user_name}}</td>
      <td>{{order.user_address}}</td>
			<td>{{order.user_phone_no}}</td>
			<td>{{order.status}}</td>
      <td>{{order.delivery_method}}</td>
      <td>{{order.category_name}}</td>
      <td>{{order.qty}}</td>
      <td ng-init="$parent.total = $parent.total + (order.amount - order.sharedamount)">{{order.amount - order.sharedamount}}</td>
			<td ng-init="$parent.shared = $parent.shared + order.sharedamount">{{order.sharedamount}}</td>
            <!-- <td><button class='btn btn-sm btn-danger' ng-click="updatePromotion(promotion._id)" data-toggle="modal" data-target="#addPromotion">Edit</button></td> -->
			<td ng-if="order.status == 'verified'"><button class='btn btn-sm btn-success' ng-click="verifyOrder(order._id, order.status)">Σε εκκρεμότητα</button></td>
			<td ng-if="order.status == 'pending'"><button class='btn btn-sm btn-success' ng-click="verifyOrder(order._id, order.status)">Επιβεβαιωμένο</button></td>
		</tr>
		<tr align="right">
			<td colspan="11">Σύνολο</td>
			<td >Μερίδιο ποσού</td>
		</tr>
		<tr align="right">
			<td colspan="11">${{total}}</td>
			<td>${{shared}}</td>
		</tr>
	</tbody>
</table>
</div>
